name: CI

on:
  push:
    branches: [ main]
  pull_request:
    branches: [ main ]

env:
  SUB_NAME: test_sub
  TENANT_NAME: test_tenant
  RESOURCE_NAME: virtual_machine
  LOCATION: westus
  ENVIRONMENT: dev
  PROJECT_NAME: training_project
  DEV_SUB_NAME: dev_sub
  DEV_TENANT_NAME: dev_tenant
  BUILD_VERSION: "1.0.0"
  ARTIFACT_NAME: training_app
  DEPLOY_REGION: westus2
  VM_SIZE: Standard_B2s
  OS_TYPE: linux
  COMMIT_AUTHOR: ${{ github.actor }}
  COMMIT_SHA: ${{ github.sha }}
  BRANCH_NAME: ${{ github.ref_name }}
  FILE: ./test.yaml
  FILE2: ./test2.json
  FILE3: ./test3.py

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v3

    - name: list the variable
      run: |
        echo "Sub_name: " ${{ env.SUB_NAME }}
        echo "Tenant_name : " ${{ env.TENANT_NAME }}
        echo "Resource_name : " ${{ env.RESOURCE_NAME }}
        echo "Location : " ${{ env.LOCATION }}
        echo "Environment : " ${{ env.ENVIRONMENT }}
        echo "Project_name : " ${{ env.PROJECT_NAME }}
        echo "Dev_sub_name : " ${{ env.DEV_SUB_NAME }}
        echo "Dev_tenant_name : " ${{ env.DEV_TENANT_NAME }}
        echo "Build_version : " ${{ env.BUILD_VERSION }}
        echo "Artifact_name : " ${{ env.ARTIFACT_NAME }}
        echo "Deploy_region : " ${{ env.DEPLOY_REGION }}
        echo "Vm_size : " ${{ env.VM_SIZE }}
        echo "Os_type : " ${{ env.OS_TYPE }}
        echo "Commit_author : " ${{ env.COMMIT_AUTHOR }}
        echo "Commit_sha : " ${{ env.COMMIT_SHA }}
        echo "Branch_name : " ${{ env.BRANCH_NAME }}

    - name: read the contents of my files
      run: |
        cat $file
        cat $file2
        cat $file3

    - name: create ZIP file
      run: |
        zip -r build-${{ github.run_number }}.zip dist/
      
    - name: upload ZIP as artifact
      uses: actions/upload-artifact@v3
      with:
        name: zipped-build
        path: build-${{ github.run_number }}.zip